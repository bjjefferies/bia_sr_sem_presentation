View(dat)
summary(dat$hs_gpa)
summary(dat)
write.csv(dat, file = "sample_admission_data_clean.csv")
summary(dat$hs_gpa)
dat %>%
group_by(ipeds_ethnicity) %>%
summarize(admit = sum(admit, na.rm = T),
accept = sum(accept, na.rm = T)) %>%
mutate(pct_admit = round( admit / sum(admit), 4),
pct_accept = round( accept / sum(accept), 4)) %>%
select(ipeds_ethnicity, admit, pct_admit, accept, pct_accept)
dat %>%
group_by(ipeds_ethnicity) %>%
summarize(enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4)) %>%
select(ipeds_ethnicity, enroll, pct_enroll, retain, pct_retain)
# create data frame for visualization rates over time
dat %>%
group_by(ipeds_ethnicity) %>%
summarize(admit = sum(admit, na.rm = T),
accept = sum(accept, na.rm = T),
enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_admit = round( admit / sum(admit), 4),
pct_accept = round( accept / sum(accept), 4),
pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4))
# create data frame for visualization rates over time
funnel_ipeds <- dat %>%
group_by(ipeds_ethnicity) %>%
summarize(admit = sum(admit, na.rm = T),
accept = sum(accept, na.rm = T),
enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_admit = round( admit / sum(admit), 4),
pct_accept = round( accept / sum(accept), 4),
pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4))
View(funnel_ipeds)
funnel_ipeds_long <- funnel_ipeds %>%
pivot_longer(cols = c(admit, accept, enroll, retain),
names_to = "funnel",
values_to = "total")
View(funnel_ipeds_long)
funnel_ipeds_long <- funnel_ipeds %>%
pivot_longer(cols = c(admit, accept, enroll, retain),
names_to = "funnel",
values_to = "total") %>%
pivot_longer(cols = c(pct_admit, pct_accept, pct_enroll, pct_retain),
names_to = "funnel_pct",
values_to = "pct")
write.csv(x = funnel_ipeds, file = "funnel_summary.csv")
funnel_ipeds_long <- funnel_ipeds %>%
pivot_longer(cols = c(admit, accept, enroll, retain,
pct_admit, pct_accept, pct_enroll, pct_retain),
names_to = c(".value", "funnel_stage"),
names_pattern = "(pct_)?(.*)")
funnel_ipeds_long <- funnel_ipeds %>%
select(ipeds_ethnicity, admit, accept, enroll, retain, pct_admit, pct_accept, pct_enroll, pct_retain) %>%
pivot_longer(cols = c(admit, accept, enroll, retain,
pct_admit, pct_accept, pct_enroll, pct_retain),
names_to = c(".value", "funnel_stage"),
names_pattern = "(pct_)?(.*)")
cols(funnel_ipeds)
names(funnel_ipeds)
funnel_ipeds_long <- funnel_ipeds %>%
select(ipeds_ethnicity, admit, accept, enroll, retain, pct_admit, pct_accept, pct_enroll, pct_retain) %>%
pivot_longer(cols = c(admit, accept, enroll, retain,
pct_admit, pct_accept, pct_enroll, pct_retain),
names_to = c("funnel_stage", ".value"),
names_pattern = "(pct_)?(.*)")
funnel_ipeds_long <- funnel_ipeds %>%
pivot_longer(cols = c(admit, accept, enroll, retain),
names_to = "funnel_stage",
values_to = "total")
funnel_ipeds_long_test <- funnel_ipeds_long %>%
mutate(pct = case_when(funnel_stage == "admit" ~ pct_admit,
funnel_stage == "accept" ~ pct_accept,
funnel_stage == "enroll" ~ pct_enroll,
funnel_stage == "retain" ~ pct_retain))
View(funnel_ipeds_long_test)
funnel_ipeds_long <- funnel_ipeds_long %>%
mutate(pct = case_when(funnel_stage == "admit" ~ pct_admit,
funnel_stage == "accept" ~ pct_accept,
funnel_stage == "enroll" ~ pct_enroll,
funnel_stage == "retain" ~ pct_retain)) %>%
select(ipeds_ethnicity, funnel_stage, total, pct)
rm(funnel_ipeds_long_test)
funnel_ipeds_long$funnel_stage <- factor(funnel_ipeds_long,
levels = c("admit", "accept", "enroll", "retain"))
funnel_ipeds_long$funnel_stage <- factor(funnel_ipeds_long$funnel_stage,
levels = c("admit", "accept", "enroll", "retain"))
funnel_ipeds_long %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_line()
funnel_ipeds_long %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_point()
funnel_ipeds_long %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_path()
funnel_ipeds_long %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_point()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino",
"White")) %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_point()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = funnel_stage, y = pct, colour = ipeds_ethnicity)) +
geom_point()
funnel_ipeds_long <- funnel_ipeds_long %>%
mutate(index = case_when(funnel_stage == "admit" ~ 1,
funnel_stage == "accept" ~ 2,
funnel_stage == "enroll" ~ 3,
funnel_stage == "retain" ~ 4,))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_path()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent)
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
labs(y = "Percent of Fall Cohort")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage))
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme(legend.title = element_blank()) +
theme_minimal()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
#
dat %>%
group_by(residency, household_income) %>%
summarize(enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4)) %>%
select(household_income, enroll, pct_enroll, retain, pct_retain)
nau_colors <- c("#003466", "#F1B300", "#00853F", "#F47722", "#00ADB5", "#E86D1F")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top",
legend.text = element_text(size = 12))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top",
legend.text = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.text.x = element_text(size = 11))
# what is the average financial aid package?
mean(dat$offered_aid_amount[dat$offered_aid_amount > 0], na.rm = T)
# what percent of students received aid?
dat %>%
summarise(pct_offered_aid = sum(offered_aid_amount > 0))
# what percent of students received aid?
dat %>%
summarise(pct_offered_aid = sum(offered_aid_amount > 0) / nrow(dat))
summary(m_log_accept)
library(gtsummary)
gtsummary::tbl_regression(m_log_accept)
gtsummary::tbl_regression(m_log_accept, exponentiate = T)
# create dummy variable for received aid
dat <- dat %>%
mutate(aid_offered = ifelse(offered_aid_amount > 0, 1, 0))
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll, na.rm = T) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll, na.rm = T) / n(),
pct_retain = sum(retain, na.rm = T) / n())
knitr::opts_chunk$set(echo = TRUE)
dat %>%
group_by(residency, ipeds_ethnicity) %>%
summarize(avg_accept_time = mean(accept_time_elapsed, na.rm = T))
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
dat %>%
group_by(residency, ipeds_ethnicity) %>%
summarize(avg_accept_time = mean(accept_time_elapsed, na.rm = T))
mean(dat$accept_time_elapsed, na.rm = T)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
dat %>%
filter(retain == 1) %>%
group_by(campus) %>%
summarise(n = n())
dat %>%
filter(enroll == 1) %>%
group_by(campus) %>%
summarise(n = n())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
unique(dat$enroll)
dat_enroll_logit <- dat %>%
mutate(enroll = ifelse(enroll == 1, 1, 0))
m_log_enroll <- glm(enroll ~ hs_gpa,
data = dat_enroll_logit,
family = binomial)
summary(m_log_enroll)
exp(m_log_enroll$coefficients[2])
m_log_enroll <- glm(enroll ~ hs_gpa + offered_aid_amount,
data = dat_enroll_logit,
family = binomial)
summary(m_log_enroll)
exp(m_log_enroll$coefficients[2])
exp(m_log_enroll$coefficients[3])
exp(m_log_enroll$coefficients[3])^1000
