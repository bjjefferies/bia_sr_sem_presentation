ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
labs(y = "Percent of Fall Cohort")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage))
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme(legend.title = element_blank()) +
theme_minimal()
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
#
dat %>%
group_by(residency, household_income) %>%
summarize(enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4)) %>%
select(household_income, enroll, pct_enroll, retain, pct_retain)
nau_colors <- c("#003466", "#F1B300", "#00853F", "#F47722", "#00ADB5", "#E86D1F")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = levels(funnel_ipeds_long$funnel_stage)) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank())
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top")
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top",
legend.text = element_text(size = 12))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "top",
legend.text = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = paste0(levels(funnel_ipeds_long$funnel_stage), "ed")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.text.x = element_text(size = 10))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.text.x = element_text(size = 11))
# what is the average financial aid package?
mean(dat$offered_aid_amount[dat$offered_aid_amount > 0], na.rm = T)
# what percent of students received aid?
dat %>%
summarise(pct_offered_aid = sum(offered_aid_amount > 0))
# what percent of students received aid?
dat %>%
summarise(pct_offered_aid = sum(offered_aid_amount > 0) / nrow(dat))
summary(m_log_accept)
library(gtsummary)
gtsummary::tbl_regression(m_log_accept)
gtsummary::tbl_regression(m_log_accept, exponentiate = T)
# create dummy variable for received aid
dat <- dat %>%
mutate(aid_offered = ifelse(offered_aid_amount > 0, 1, 0))
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll, na.rm = T) / n())
# what percent of students receiving aid accept and then enroll and then retain?
dat %>%
group_by(aid_offered) %>%
summarise(pct_accept = sum(accept) / n(),
pct_enroll = sum(enroll, na.rm = T) / n(),
pct_retain = sum(retain, na.rm = T) / n())
knitr::opts_chunk$set(echo = TRUE)
dat %>%
group_by(residency, ipeds_ethnicity) %>%
summarize(avg_accept_time = mean(accept_time_elapsed, na.rm = T))
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
dat %>%
group_by(residency, ipeds_ethnicity) %>%
summarize(avg_accept_time = mean(accept_time_elapsed, na.rm = T))
mean(dat$accept_time_elapsed, na.rm = T)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
dat %>%
filter(retain == 1) %>%
group_by(campus) %>%
summarise(n = n())
dat %>%
filter(enroll == 1) %>%
group_by(campus) %>%
summarise(n = n())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
unique(dat$enroll)
dat_enroll_logit <- dat %>%
mutate(enroll = ifelse(enroll == 1, 1, 0))
m_log_enroll <- glm(enroll ~ hs_gpa,
data = dat_enroll_logit,
family = binomial)
summary(m_log_enroll)
exp(m_log_enroll$coefficients[2])
m_log_enroll <- glm(enroll ~ hs_gpa + offered_aid_amount,
data = dat_enroll_logit,
family = binomial)
summary(m_log_enroll)
exp(m_log_enroll$coefficients[2])
exp(m_log_enroll$coefficients[3])
exp(m_log_enroll$coefficients[3])^1000
knitr::opts_chunk$set(echo = TRUE)
summary(m_log_enroll)
exp(m_log_enroll$coefficients[3])
# odd ratio of increasing financial aid $1000
exp(m_log_enroll$coefficients[3]) ^1000
# odds-ratio of increasing GPA by 1 pt.
exp(m_log_enroll$coefficients[2])
# dataset restriction to only those students who accepted
dat_accepted <- dat %>%
filter(accept == 1)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
# dataset restriction to only those students who accepted
dat_accepted <- dat %>%
filter(accept == 1)
# model on effect of ipeds ethnicity
m_log_enroll_1 <- glm(enroll ~ hs_gpa + offered_aid_amount,
data = dat_accepted,
family = binomial)
summary(m_log_enroll_1)
summary(m_log_enroll)
unique(dat_accepted$enroll)
# model ethnicity effect on enroll
m_log_enroll_2 <- glm(enroll ~ hs_gpa + offered_aid_amount + ipeds_ethnicity,
data = dat_accepted,
family = binomial)
summary(m_log_enroll_2)
summary(m_log_enroll_2)
exp(m_log_enroll_2$coefficients)
# model ethnicity effect on enroll
m_log_enroll_3 <- glm(enroll ~ ipeds_ethnicity,
data = dat_accepted,
family = binomial)
summary(m_log_enroll_3)
summary(m_log_accept_controls)
# Indigenous is the reference group, so add the intercept to the coefficient for offered aid
log_odds_indig <- m_log_accept_controls$coefficients[2] + m_log_accept_controls$coefficients[1]
odds_ratio_indig <- exp(log_odds_indig)
odds_ratio_indig <- odds_ratio_indig^1000
odds_ratio_indig
oddsRatio
# What are values of quartiles of financial aid offers
quantile(dat$offered_aid_amount,
probs = c(0,0.25,0.5,0.75))
max(dat$offered_aid_amount)
# Model financial aid and household income effects on enrollments
m_log_enroll_4 <- glm(enroll ~ offered_aid_amount + household_income,
data = dat_accepted,
family = binomial)
summary(m_log_enroll_4)
m_log_enroll_4$coefficients[2]
exp(m_log_enroll_4$coefficients[2])
exp(m_log_enroll_4$coefficients[2])^1000
exp(m_log_enroll_4$coefficients[11])
library(margins)
margins::margins(m_log_enroll_4)
me_m_log_4 <- margins::margins(m_log_enroll_4)
summary(me_m_log_4)
me_m_log_4
me_m_log_4$
margins::
9.04066e-06*1000
me_m_log_accept <- margins::margins(m_log_accept)
summary(me_m_log_accept)
me_m_log_accept_c <- margins::margins(m_log_accept_controls)
summary(me_m_log_accept_c)
me_m_log_accept_c
9.767533e-06*5000
9.04066e-06*5000
summary(me_m_log_accept_c)
# logit model with interaction between offered aid amount and household income
m_log_enroll_5 <- glm(enroll ~ offered_aid_amount * household_income,
data = dat_accepted,
family = binomial)
summary(m_log_enroll_5)
me_m_log_enroll_5 <- margins::margins(m_log_enroll_5)
summary(me_m_log_enroll_5)
summary(m_log_enroll_5)
summary(me_m_log_enroll_5)
knitr::opts_chunk$set(echo = TRUE)
summary(me_m_log_enroll_5)
library(tidyverse)
library(xray)
library(readr)
library(readxl)
library(here)
library(janitor)
library(gtsummary)
library(margins)
summary(me_m_log_enroll_5)
#AVERAGE AID OFFER BY Household Income
dat %>%
group_by(household_income) %>%
summarise(avg_aid_offer = sum(offered_aid_amount, na.rm = T) / sum(admit, na.rm = T))
funnel_ipeds_long %>%
filter(ipeds_ethnicity %in% c("American Indian/Alaska Native",
"Hispanic/Latino")) %>%
ggplot(aes(x = index, y = pct, colour = ipeds_ethnicity)) +
geom_point() +
geom_path(lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = c("admitted", "accepted", "enrolled", "retained")) +
scale_color_manual(values = nau_colors) +
labs(y = "Percent of Fall Cohort",
x = "Funnel Stage") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.text.x = element_text(size = 11))
# create data frame for visualization rates over time
funnel_ipeds_gen <- dat %>%
group_by(ipeds_ethnicity, gender) %>%
summarize(admit = sum(admit, na.rm = T),
accept = sum(accept, na.rm = T),
enroll = sum(enroll, na.rm = T),
retain = sum(retain, na.rm = T)) %>%
mutate(pct_admit = round( admit / sum(admit), 4),
pct_accept = round( accept / sum(accept), 4),
pct_enroll = round( enroll / sum(enroll), 4),
pct_retain = round( retain / sum(retain), 4))
funnel_ipeds_gen
unique(dat$ipeds_ethnicity)
dat %>%
filter(ipeds_ethnicity %in% c("Hispanic/Latino", "American Indian/Alaska Native")) %>%
group_by(ipeds_ethnicity, gender) %>%
summarise(pct_accept = sum(accept, na.rm = T) / sum(admit, na.rm = T))
dat %>%
filter(ipeds_ethnicity %in% c("Hispanic/Latino", "American Indian/Alaska Native")) %>%
group_by(ipeds_ethnicity, gender) %>%
summarise(pct_accept = sum(accept, na.rm = T) / sum(admit, na.rm = T),
pct_enroll = sum(enroll, na.rm = T) / sum(accept, na.rm = T))
dat %>%
filter(ipeds_ethnicity %in% c("Hispanic/Latino", "American Indian/Alaska Native")) %>%
group_by(ipeds_ethnicity, gender) %>%
summarise(pct_accept = sum(accept, na.rm = T) / sum(admit, na.rm = T),
pct_enroll = sum(enroll, na.rm = T) / sum(accept, na.rm = T),
pct_retain = sum(retain, na.rm = T) / sum(enroll, na.rm = T))
library(pander)
install.packages("pander")
library(pander)
dat %>%
filter(ipeds_ethnicity %in% c("Hispanic/Latino", "American Indian/Alaska Native")) %>%
group_by(ipeds_ethnicity, gender) %>%
summarise(pct_accept = sum(accept, na.rm = T) / sum(admit, na.rm = T),
pct_enroll = sum(enroll, na.rm = T) / sum(accept, na.rm = T),
pct_retain = sum(retain, na.rm = T) / sum(enroll, na.rm = T)) %>%
pander()
# What are values of quartiles of financial aid offers
quantile(dat$offered_aid_amount,
probs = c(0,0.25,0.5,0.75))
